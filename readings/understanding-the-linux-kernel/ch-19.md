## Chapter-19 进程间通信

Unix系统提供的进程间通信机制：

- 管道和FIFO（命名管道）
- 信号量
- 消息
- 共享内存区
- 套接字

### 1.1 使用管道

管道被看作是打开的文件，但在已安装的文件系统中没有相应的**映像**。

可以使用`pipe()`系统调用来创建一个新的管道，这个系统调用返回**一对**文件描述符，然后进程通过`fork()`把这两个文件描述符传递给它的子进程，由此与子进程共享管道。

进程可以在`read()`系统调用中使用第一个文件描述符从管道中读取数据，同样也可以在`write()`系统调用中使用第二个文件描述符向管道中写入数据。

> NOTE: **POSIX**只定义了半双工的管道，因此即使`pipe()`系统调用返回了两个文件描述符，每个进程在使用一个文件描述之前仍得把另外一个文件描述符关闭。如果所需要的是双向数据流，那么进程必须通过两次调用`pipe()`来使用两个不同的管道。

但是，Linux的解决办法：每个管道的文件描述符仍然都是单向的，但是在使用一个描述符之前不必把另外一个描述符关闭。

### 1.2 匿名管道的缺点

虽然`管道`是一种十分简单、灵活、有效的通信机制，但它有一个主要的缺点，也就是无法打开已经存在的管道。这就使得任意的两个进程不可能共享同一个管道，除非管道由一个共同的祖先进程创建。

### 2.1 FIFO

为了突破这种限制，Unix系统引入一种称为`命名管道（named pipe）`或者FIFO代表“先进先出”：最先写入的字节总是被最先读出的特殊文件类型。

```
// 创建命名管道
int fid = mknod("file_path", "r");
```